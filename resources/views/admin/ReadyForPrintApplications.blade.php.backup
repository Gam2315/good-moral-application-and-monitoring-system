<x-dashboard-layout>
  <x-slot name="roleTitle">Admin</x-slot>

  <x-slot name="navigation">
    <x-admin-navigation />
  </x-slot>

  <!-- Header Section -->
  <div class="header-section">
    <div>
      <h1 class="role-title">Certificate Applications</h1>
      <p class="welcome-text">Review and manage Good Moral and Residency certificate applications</p>
      <div class="accent-line"></div>
    </div>
  </div>
  <!-- Status Messages -->
  @if(session('success'))
  <div style="margin-bottom: 24px; padding: 16px; background: #d4edda; color: #155724; border: 1px solid #c3e6cb; border-radius: 8px;">
    {{ session('success') }}
  </div>
  @endif

  @if(session('pdf_url'))
  <script>
    window.addEventListener('load', function() {
      window.open("{{ session('pdf_url') }}", '_blank');
    });
  </script>
  @endif

  <!-- Filter Tabs -->
  <div style="background: white; border-radius: 12px 12px 0 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); margin-top: 24px;">
    <div style="display: flex; border-bottom: 1px solid #e9ecef;">
      <button onclick="showTab('all')" id="tab-all" class="tab-button active" style="flex: 1; padding: 16px; border: none; background: none; cursor: pointer; font-weight: 600; color: var(--primary-green); border-bottom: 3px solid var(--primary-green);">
        All Applications ({{ $applications['all_good_moral']->count() }})
      </button>
      <button onclick="showTab('good_moral')" id="tab-good_moral" class="tab-button" style="flex: 1; padding: 16px; border: none; background: none; cursor: pointer; font-weight: 600; color: #6c757d; border-bottom: 3px solid transparent;">
        Good Moral ({{ $applications['good_moral']->count() }})
      </button>
      <button onclick="showTab('residency')" id="tab-residency" class="tab-button" style="flex: 1; padding: 16px; border: none; background: none; cursor: pointer; font-weight: 600; color: #6c757d; border-bottom: 3px solid transparent;">
        Residency ({{ $applications['residency']->count() }})
      </button>
    </div>
  </div>

  <!-- All Applications Tab -->
  <div id="content-all" class="tab-content" style="background: white; border-radius: 0 0 12px 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
    <div style="padding: 24px; border-bottom: 1px solid #e9ecef;">
      <h2 style="margin: 0; color: var(--primary-green); font-size: 1.25rem; font-weight: 600;">All Certificate Applications</h2>
    </div>

    @if($applications['all_good_moral']->isEmpty())
    <div style="padding: 48px; text-align: center; color: #6c757d;">
      <svg style="width: 64px; height: 64px; margin: 0 auto 16px; color: #dee2e6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
      </svg>
      <p style="margin: 0; font-size: 1.1rem; font-weight: 500;">No applications available</p>
    </div>
    @else
    <div style="overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="background: #f8f9fa; border-bottom: 2px solid #e9ecef;">
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Student ID</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Full Name</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Department</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Certificate Type</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Date Applied</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Status</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          @foreach($applications['all_good_moral'] as $application)
          @php
            $receipt = \App\Models\Receipt::where('reference_num', $application->reference_number)->first();
          @endphp
          <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s ease;"
              onmouseover="this.style.backgroundColor='#f8f9fa'"
              onmouseout="this.style.backgroundColor='transparent'">
            <td style="padding: 16px; color: #495057; font-size: 14px; font-weight: 500;">{{ $application->student_id }}</td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">{{ $application->fullname }}</td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <span style="display: inline-block; padding: 4px 8px; background: var(--light-green); color: var(--primary-green); border-radius: 4px; font-size: 12px; font-weight: 500;">
                {{ $application->department }}
              </span>
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <span style="display: inline-block; padding: 4px 8px;
                    background: {{ $application->certificate_type === 'good_moral' ? '#e8f5e8' : '#fff3cd' }};
                    color: {{ $application->certificate_type === 'good_moral' ? 'var(--primary-green)' : '#856404' }};
                    border-radius: 4px; font-size: 12px; font-weight: 500;">
                {{ $application->certificate_type === 'good_moral' ? 'Good Moral' : 'Residency' }}
              </span>
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <span style="color: #6c757d; font-size: 13px;">
                {{ $application->created_at->format('M j, Y') }}
              </span>
              <br>
              <span style="color: #9ca3af; font-size: 11px;">
                {{ $application->created_at->format('g:i A') }}
              </span>
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              @if($application->application_status === 'Approved by Administrator')
                <span style="display: inline-block; padding: 6px 12px; background: #ffc10720; color: #ffc107; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  Payment Pending
                </span>
              @elseif($application->application_status === 'Ready for Print')
                <span style="display: inline-block; padding: 6px 12px; background: #28a74520; color: #28a745; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  Ready for Print
                </span>
              @elseif($application->application_status === 'Ready for Pickup')
                <span style="display: inline-block; padding: 6px 12px; background: #28a74520; color: #28a745; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  Printed
                </span>
              @else
                <span style="display: inline-block; padding: 6px 12px; background: #6c757d20; color: #6c757d; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  {{ $application->application_status }}
                </span>
              @endif
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                <button data-application='@json($application)' onclick="openGoodMoralModal(this)"
                        style="background: #007bff; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                  View Details
                </button>

                @if($application->application_status === 'Approved by Administrator' && $receipt && $receipt->document_path)
                  <form action="{{ route('admin.printCertificate', $application->id) }}" method="POST" style="display: inline;">
                    @csrf
                    <button type="submit"
                            onclick="return confirm('Are you sure you want to print this certificate? This will mark it as ready for pickup.')"
                            style="background: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                      Print Certificate
                    </button>
                  </form>
                @elseif($application->application_status === 'Ready for Pickup' && $receipt && $receipt->document_path)
                  <a href="{{ route('admin.downloadCertificate', $application->id) }}"
                     style="background: #17a2b8; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; text-decoration: none; display: inline-flex; align-items: center; gap: 6px; margin-right: 8px;">
                    <svg style="width: 12px; height: 12px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Download
                  </a>
                  <form action="{{ route('admin.printCertificate', $application->id) }}" method="POST" style="display: inline;">
                    @csrf
                    <button type="submit"
                            onclick="return confirm('Are you sure you want to reprint this certificate?')"
                            style="background: #ffc107; color: #212529; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                      Reprint
                    </button>
                  </form>
                @endif

                @if($receipt && $receipt->document_path)
                <a href="{{ route('files.serve', $receipt->document_path) }}" target="_blank"
                   style="background: #6f42c1; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; text-decoration: none; display: inline-block;">
                  View Receipt
                </a>
                @else
                <span style="color: #6c757d; font-size: 12px; font-style: italic; padding: 8px 12px; background: #f8f9fa; border-radius: 6px;">
                  No receipt uploaded
                </span>
                @endif
              </div>
            </td>
          </tr>
          @endforeach
        </tbody>
      </table>
    </div>

    <!-- Pagination Links -->
    @if($applications['all_good_moral']->hasPages())
    <div style="margin-top: 24px; display: flex; justify-content: center;">
      {{ $applications['all_good_moral']->links() }}
    </div>
    @endif
    @endif
  </div>

  <!-- Good Moral Applications Tab -->
  <div id="content-good_moral" class="tab-content" style="background: white; border-radius: 0 0 12px 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden; display: none;">
    <div style="padding: 24px; border-bottom: 1px solid #e9ecef;">
      <h2 style="margin: 0; color: var(--primary-green); font-size: 1.25rem; font-weight: 600;">Good Moral Certificate Applications</h2>
    </div>

    @if($applications['good_moral']->isEmpty())
    <div style="padding: 48px; text-align: center; color: #6c757d;">
      <svg style="width: 64px; height: 64px; margin: 0 auto 16px; color: #dee2e6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
      </svg>
      <p style="margin: 0; font-size: 1.1rem; font-weight: 500;">No Good Moral applications available</p>
    </div>
    @else
    <div style="overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="background: #f8f9fa; border-bottom: 2px solid #e9ecef;">
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Student ID</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Full Name</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Department</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Date Applied</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Status</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          @foreach($applications['good_moral'] as $application)
          @php
            $receipt = \App\Models\Receipt::where('reference_num', $application->reference_number)->first();
          @endphp
          <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s ease;"
              onmouseover="this.style.backgroundColor='#f8f9fa'"
              onmouseout="this.style.backgroundColor='transparent'">
            <td style="padding: 16px; color: #495057; font-size: 14px; font-weight: 500;">{{ $application->student_id }}</td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">{{ $application->fullname }}</td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <span style="display: inline-block; padding: 4px 8px; background: var(--light-green); color: var(--primary-green); border-radius: 4px; font-size: 12px; font-weight: 500;">
                {{ $application->department }}
              </span>
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <span style="color: #6c757d; font-size: 13px;">
                {{ $application->created_at->format('M j, Y') }}
              </span>
              <br>
              <span style="color: #9ca3af; font-size: 11px;">
                {{ $application->created_at->format('g:i A') }}
              </span>
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              @php
                $receipt = \App\Models\Receipt::where('reference_num', $application->reference_number)->first();
                $hasReceipt = $receipt && $receipt->document_path;
              @endphp

              @if($application->application_status === 'Approved by Administrator')
                @if($hasReceipt)
                  <span style="display: inline-block; padding: 6px 12px; background: #28a74520; color: #28a745; border-radius: 20px; font-size: 12px; font-weight: 500;">
                    Ready to Print
                  </span>
                @else
                  <span style="display: inline-block; padding: 6px 12px; background: #ffc10720; color: #ffc107; border-radius: 20px; font-size: 12px; font-weight: 500;">
                    Pending
                  </span>
                @endif
              @elseif($application->application_status === 'Ready for Pickup')
                <span style="display: inline-block; padding: 6px 12px; background: #28a74520; color: #28a745; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  Printed
                </span>
              @else
                <span style="display: inline-block; padding: 6px 12px; background: #6c757d20; color: #6c757d; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  {{ $application->application_status }}
                </span>
              @endif
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                <button data-application='@json($application)' onclick="openGoodMoralModal(this)"
                        style="background: #007bff; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                  View Details
                </button>

                @if($application->application_status === 'Approved by Administrator' && $receipt && $receipt->document_path)
                  <form action="{{ route('admin.printCertificate', $application->id) }}" method="POST" style="display: inline;">
                    @csrf
                    <button type="submit"
                            onclick="return confirm('Are you sure you want to print this certificate? This will mark it as ready for pickup.')"
                            style="background: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                      Print Certificate
                    </button>
                  </form>
                @elseif($application->application_status === 'Ready for Pickup' && $receipt && $receipt->document_path)
                  <a href="{{ route('admin.downloadCertificate', $application->id) }}"
                     style="background: #17a2b8; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; text-decoration: none; display: inline-flex; align-items: center; gap: 6px; margin-right: 8px;">
                    <svg style="width: 12px; height: 12px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Download
                  </a>
                  <form action="{{ route('admin.printCertificate', $application->id) }}" method="POST" style="display: inline;">
                    @csrf
                    <button type="submit"
                            onclick="return confirm('Are you sure you want to reprint this certificate?')"
                            style="background: #ffc107; color: #212529; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                      Reprint
                    </button>
                  </form>
                @endif

                @if($receipt && $receipt->document_path)
                <a href="{{ route('files.serve', $receipt->document_path) }}" target="_blank"
                   style="background: #6f42c1; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; text-decoration: none; display: inline-block;">
                  View Receipt
                </a>
                @else
                <span style="color: #6c757d; font-size: 12px; font-style: italic; padding: 8px 12px; background: #f8f9fa; border-radius: 6px;">
                  No receipt uploaded
                </span>
                @endif
              </div>
            </td>
          </tr>
          @endforeach
        </tbody>
      </table>
    </div>

    <!-- Pagination Links -->
    @if($applications['good_moral']->hasPages())
    <div style="margin-top: 24px; display: flex; justify-content: center;">
      {{ $applications['good_moral']->links() }}
    </div>
    @endif
    @endif
  </div>

  <!-- Residency Applications Tab -->
  <div id="content-residency" class="tab-content" style="background: white; border-radius: 0 0 12px 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden; display: none;">
    <div style="padding: 24px; border-bottom: 1px solid #e9ecef;">
      <h2 style="margin: 0; color: #856404; font-size: 1.25rem; font-weight: 600;">Certificate of Residency Applications</h2>
    </div>

    @if($applications['residency']->isEmpty())
    <div style="padding: 48px; text-align: center; color: #6c757d;">
      <svg style="width: 64px; height: 64px; margin: 0 auto 16px; color: #dee2e6;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
      </svg>
      <p style="margin: 0; font-size: 1.1rem; font-weight: 500;">No Residency applications available</p>
    </div>
    @else
    <div style="overflow-x: auto;">
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr style="background: #f8f9fa; border-bottom: 2px solid #e9ecef;">
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Student ID</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Full Name</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Department</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Date Applied</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Status</th>
            <th style="padding: 16px; text-align: left; font-weight: 600; color: #495057; font-size: 14px;">Actions</th>
          </tr>
        </thead>
        <tbody>
          @foreach($applications['residency'] as $application)
          @php
            $receipt = \App\Models\Receipt::where('reference_num', $application->reference_number)->first();
          @endphp
          <tr style="border-bottom: 1px solid #e9ecef; transition: background-color 0.2s ease;"
              onmouseover="this.style.backgroundColor='#f8f9fa'"
              onmouseout="this.style.backgroundColor='transparent'">
            <td style="padding: 16px; color: #495057; font-size: 14px; font-weight: 500;">{{ $application->student_id }}</td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">{{ $application->fullname }}</td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <span style="display: inline-block; padding: 4px 8px; background: #fff3cd; color: #856404; border-radius: 4px; font-size: 12px; font-weight: 500;">
                {{ $application->department }}
              </span>
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <span style="color: #6c757d; font-size: 13px;">
                {{ $application->created_at->format('M j, Y') }}
              </span>
              <br>
              <span style="color: #9ca3af; font-size: 11px;">
                {{ $application->created_at->format('g:i A') }}
              </span>
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              @if($application->application_status === 'Approved by Administrator')
                @if($receipt && $receipt->document_path)
                  <span style="display: inline-block; padding: 6px 12px; background: #28a74520; color: #28a745; border-radius: 20px; font-size: 12px; font-weight: 500;">
                    Ready to Print
                  </span>
                @else
                  <span style="display: inline-block; padding: 6px 12px; background: #ffc10720; color: #ffc107; border-radius: 20px; font-size: 12px; font-weight: 500;">
                    Pending
                  </span>
                @endif
              @elseif($application->application_status === 'Ready for Pickup')
                <span style="display: inline-block; padding: 6px 12px; background: #28a74520; color: #28a745; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  Printed
                </span>
              @else
                <span style="display: inline-block; padding: 6px 12px; background: #6c757d20; color: #6c757d; border-radius: 20px; font-size: 12px; font-weight: 500;">
                  {{ $application->application_status }}
                </span>
              @endif
            </td>
            <td style="padding: 16px; color: #495057; font-size: 14px;">
              <div style="display: flex; gap: 8px; align-items: center; flex-wrap: wrap;">
                <button data-application='@json($application)' onclick="openGoodMoralModal(this)"
                        style="background: #007bff; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                  View Details
                </button>

                @if($application->application_status === 'Approved by Administrator' && $receipt && $receipt->document_path)
                  <form action="{{ route('admin.printCertificate', $application->id) }}" method="POST" style="display: inline;">
                    @csrf
                    <button type="submit"
                            onclick="return confirm('Are you sure you want to print this certificate? This will mark it as ready for pickup.')"
                            style="background: #28a745; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                      Print Certificate
                    </button>
                  </form>
                @elseif($application->application_status === 'Ready for Pickup' && $receipt && $receipt->document_path)
                  <a href="{{ route('admin.downloadCertificate', $application->id) }}"
                     style="background: #17a2b8; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; text-decoration: none; display: inline-flex; align-items: center; gap: 6px; margin-right: 8px;">
                    <svg style="width: 12px; height: 12px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                    </svg>
                    Download
                  </a>
                  <form action="{{ route('admin.printCertificate', $application->id) }}" method="POST" style="display: inline;">
                    @csrf
                    <button type="submit"
                            onclick="return confirm('Are you sure you want to reprint this certificate?')"
                            style="background: #ffc107; color: #212529; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">
                      Reprint
                    </button>
                  </form>
                @endif

                @if($receipt && $receipt->document_path)
                <a href="{{ route('files.serve', $receipt->document_path) }}" target="_blank"
                   style="background: #6f42c1; color: white; border: none; padding: 8px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; text-decoration: none; display: inline-block;">
                  View Receipt
                </a>
                @else
                <span style="color: #6c757d; font-size: 12px; font-style: italic; padding: 8px 12px; background: #f8f9fa; border-radius: 6px;">
                  No receipt uploaded
                </span>
                @endif
              </div>
            </td>
          </tr>
          @endforeach
        </tbody>
      </table>
    </div>

    <!-- Pagination Links -->
    @if($applications['residency']->hasPages())
    <div style="margin-top: 24px; display: flex; justify-content: center;">
      {{ $applications['residency']->links() }}
    </div>
    @endif
    @endif
  </div>

  <!-- Print Confirmation Modal -->
  <div id="printModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); z-index: 1001; align-items: center; justify-content: center; backdrop-filter: blur(4px);">
    <div style="background: white; padding: 0; border-radius: 16px; box-shadow: 0 25px 50px rgba(0,0,0,0.25); width: 100%; max-width: 450px; margin: 20px; animation: modalSlideIn 0.3s ease;">
      <div style="position: relative;">
        <!-- Header -->
        <div style="background: linear-gradient(135deg, #28a745, #20c997); color: white; padding: 24px; border-radius: 16px 16px 0 0; text-align: center; position: relative;">
          <div style="width: 64px; height: 64px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center;">
            <svg style="width: 32px; height: 32px;" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 700;">Print Certificate</h3>
          <p style="margin: 0; opacity: 0.9; font-size: 14px;">Student: <span id="printStudentName" style="font-weight: 600;"></span></p>
          <p style="margin: 4px 0 0 0; opacity: 0.8; font-size: 12px;">Ref: <span id="printRefNumber" style="font-weight: 600;"></span></p>
          <button onclick="closePrintModal()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 24px; cursor: pointer; opacity: 0.8; transition: opacity 0.2s; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%;" onmouseover="this.style.opacity='1'; this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.opacity='0.8'; this.style.background='transparent'">√ó</button>
        </div>
        
        <!-- Content -->
        <div style="padding: 32px;">
          <div style="background: #f0f9ff; padding: 16px; border-radius: 12px; border: 1px solid #bae6fd; margin-bottom: 24px;">
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
              <div style="width: 32px; height: 32px; background: #bae6fd; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <svg style="width: 16px; height: 16px; color: #0ea5e9;" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                </svg>
              </div>
              <div>
                <strong style="color: #0369a1; font-size: 14px; display: block; margin-bottom: 4px;">üñ®Ô∏è Confirm Certificate Printing</strong>
                <p style="margin: 0; color: #0369a1; font-size: 13px; line-height: 1.4;">Are you sure you want to print this certificate? This action will mark it as ready for pickup.</p>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div style="display: flex; gap: 16px;">
            <button type="button" onclick="closePrintModal()" style="flex: 1; padding: 14px 20px; background: #e2e8f0; color: #2d3748; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 15px;" onmouseover="this.style.background='#cbd5e0'" onmouseout="this.style.background='#e2e8f0'">
              ‚ùå Cancel
            </button>
            <button type="button" onclick="submitPrint()" id="printSubmitBtn" style="flex: 1; padding: 14px 20px; background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3); font-size: 15px;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(40, 167, 69, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(40, 167, 69, 0.3)'">
              üñ®Ô∏è Print Certificate
            </button>
          </div>
        </div>
        
        <!-- Hidden fields for application data -->
        <input type="hidden" id="printApplicationId" value="">
      </div>
    </div>
  </div>

  <!-- Reprint Confirmation Modal -->
  <div id="reprintModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.6); z-index: 1001; align-items: center; justify-content: center; backdrop-filter: blur(4px);">
    <div style="background: white; padding: 0; border-radius: 16px; box-shadow: 0 25px 50px rgba(0,0,0,0.25); width: 100%; max-width: 450px; margin: 20px; animation: modalSlideIn 0.3s ease;">
      <div style="position: relative;">
        <!-- Header -->
        <div style="background: linear-gradient(135deg, #ffc107, #e0a800); color: white; padding: 24px; border-radius: 16px 16px 0 0; text-align: center; position: relative;">
          <div style="width: 64px; height: 64px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; margin: 0 auto 16px; display: flex; align-items: center; justify-content: center;">
            <svg style="width: 32px; height: 32px;" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"></path>
            </svg>
          </div>
          <h3 style="margin: 0 0 8px 0; font-size: 22px; font-weight: 700;">Reprint Certificate</h3>
          <p style="margin: 0; opacity: 0.9; font-size: 14px;">Student: <span id="reprintStudentName" style="font-weight: 600;"></span></p>
          <p style="margin: 4px 0 0 0; opacity: 0.8; font-size: 12px;">Ref: <span id="reprintRefNumber" style="font-weight: 600;"></span></p>
          <button onclick="closeReprintModal()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 24px; cursor: pointer; opacity: 0.8; transition: opacity 0.2s; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; border-radius: 50%;" onmouseover="this.style.opacity='1'; this.style.background='rgba(255,255,255,0.1)'" onmouseout="this.style.opacity='0.8'; this.style.background='transparent'">√ó</button>
        </div>
        
        <!-- Content -->
        <div style="padding: 32px;">
          <div style="background: #fffbeb; padding: 16px; border-radius: 12px; border: 1px solid #fed7aa; margin-bottom: 24px;">
            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 12px;">
              <div style="width: 32px; height: 32px; background: #fed7aa; border-radius: 50%; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                <svg style="width: 16px; height: 16px; color: #ea580c;" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                </svg>
              </div>
              <div>
                <strong style="color: #ea580c; font-size: 14px; display: block; margin-bottom: 4px;">üîÑ Confirm Certificate Reprint</strong>
                <p style="margin: 0; color: #ea580c; font-size: 13px; line-height: 1.4;">Generate a new copy of this certificate. The filename will include "REPRINT" for identification.</p>
              </div>
            </div>
          </div>
          
          <!-- Action Buttons -->
          <div style="display: flex; gap: 16px;">
            <button type="button" onclick="closeReprintModal()" style="flex: 1; padding: 14px 20px; background: #e2e8f0; color: #2d3748; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; font-size: 15px;" onmouseover="this.style.background='#cbd5e0'" onmouseout="this.style.background='#e2e8f0'">
              ‚ùå Cancel
            </button>
            <button type="button" onclick="submitReprint()" id="reprintSubmitBtn" style="flex: 1; padding: 14px 20px; background: linear-gradient(135deg, #ffc107, #e0a800); color: #212529; border: none; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(255, 193, 7, 0.3); font-size: 15px;" onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 6px 20px rgba(255, 193, 7, 0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 15px rgba(255, 193, 7, 0.3)'">
              üîÑ Reprint Certificate
            </button>
          </div>
        </div>
        
        <!-- Hidden fields for application data -->
        <input type="hidden" id="reprintApplicationId" value="">
      </div>
    </div>
  </div>

  <!-- Modal -->
  <div id="modal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; display: none;">
    <div style="background: white; padding: 24px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); width: 100%; max-width: 500px; margin: 20px;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h3 style="margin: 0; color: var(--primary-green); font-size: 1.25rem; font-weight: 600;">Application Details</h3>
        <button onclick="closeModal()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #6c757d;">&times;</button>
      </div>

      <div style="display: grid; gap: 12px;">
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Full Name:</strong>
          <span id="modalFullName"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Reference Number:</strong>
          <span id="modalrefnum"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Number of Copies:</strong>
          <span id="modalnumcop"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #e8f5e8; border-radius: 6px;">
          <strong>Payment Amount:</strong>
          <span id="modalPaymentAmount" style="color: var(--primary-green); font-weight: 600;"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Certificate Type:</strong>
          <span id="modalCertificateType"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Status:</strong>
          <span id="modalStatus"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Reason:</strong>
          <span id="modalReason"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Course Completed:</strong>
          <span id="modalCourseCompleted"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Graduation Date:</strong>
          <span id="modalGraduationDate"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Undergraduate:</strong>
          <span id="modalUndergraduate"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Last Course Year Level:</strong>
          <span id="modalLastCourseYearLevel"></span>
        </div>
        <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 6px;">
          <strong>Last Semester SY:</strong>
          <span id="modalLastSemesterSY"></span>
        </div>
      </div>

      <div style="display: flex; justify-content: flex-end; gap: 12px; margin-top: 24px;">
        <button onclick="closeModal()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">
          Close
        </button>
      </div>
    </div>
  </div>

  <!-- Modal Script -->
  <script>
    // Tab functionality
    function showTab(tabName) {
      // Hide all tab contents
      const contents = document.querySelectorAll('.tab-content');
      contents.forEach(content => content.style.display = 'none');

      // Remove active class from all tabs
      const tabs = document.querySelectorAll('.tab-button');
      tabs.forEach(tab => {
        tab.style.color = '#6c757d';
        tab.style.borderBottomColor = 'transparent';
      });

      // Show selected tab content
      document.getElementById('content-' + tabName).style.display = 'block';

      // Add active class to selected tab
      const activeTab = document.getElementById('tab-' + tabName);
      activeTab.style.color = 'var(--primary-green)';
      activeTab.style.borderBottomColor = 'var(--primary-green)';
    }

    // Print Modal Functions
    function openPrintModal(applicationId, studentName, refNumber) {
      const modal = document.getElementById('printModal');
      const studentNameElement = document.getElementById('printStudentName');
      const refNumberElement = document.getElementById('printRefNumber');
      
      // Set modal data
      document.getElementById('printApplicationId').value = applicationId;
      studentNameElement.textContent = studentName;
      refNumberElement.textContent = refNumber;
      
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closePrintModal() {
      document.getElementById('printModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    // Submit Print with AJAX
    async function submitPrint() {
      const applicationId = document.getElementById('printApplicationId').value;
      const submitBtn = document.getElementById('printSubmitBtn');
      const studentName = document.getElementById('printStudentName').textContent;
      
      if (!applicationId) return;
      
      // Show loading state
      const originalContent = submitBtn.innerHTML;
      submitBtn.innerHTML = `
        <svg style="width: 14px; height: 14px; animation: spin 1s linear infinite;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
        </svg>
        Printing...
      `;
      submitBtn.disabled = true;
      
      try {
        const formData = new FormData();
        formData.append('_token', document.querySelector('meta[name="csrf-token"]').getAttribute('content'));
        
        const response = await fetch(`/admin/print-certificate/${applicationId}`, {
          method: 'POST',
          body: formData
        });
        
        if (response.ok) {
          // Close modal
          closePrintModal();
          
          // Show success notification
          showSuccessToast(`üñ®Ô∏è Certificate printed successfully! Student: ${studentName}`);
          
          // Refresh page after delay
          setTimeout(() => {
            window.location.reload();
          }, 2000);
        } else {
          throw new Error('Failed to print certificate');
        }
      } catch (error) {
        console.error('Error printing certificate:', error);
        showErrorToast('‚ùå Error printing certificate. Please try again.');
        
        // Reset button
        submitBtn.innerHTML = originalContent;
        submitBtn.disabled = false;
      }
    }

    // Reprint Modal Functions
    function openReprintModal(applicationId, studentName, refNumber) {
      const modal = document.getElementById('reprintModal');
      const studentNameElement = document.getElementById('reprintStudentName');
      const refNumberElement = document.getElementById('reprintRefNumber');
      
      // Set modal data
      document.getElementById('reprintApplicationId').value = applicationId;
      studentNameElement.textContent = studentName;
      refNumberElement.textContent = refNumber;
      
      modal.style.display = 'flex';
      document.body.style.overflow = 'hidden';
    }

    function closeReprintModal() {
      document.getElementById('reprintModal').style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    // Submit Reprint with AJAX
    async function submitReprint() {
      const applicationId = document.getElementById('reprintApplicationId').value;
      const submitBtn = document.getElementById('reprintSubmitBtn');
      const studentName = document.getElementById('reprintStudentName').textContent;
      
      if (!applicationId) return;
      
      // Show loading state
      const originalContent = submitBtn.innerHTML;
      submitBtn.innerHTML = `
        <svg style="width: 14px; height: 14px; animation: spin 1s linear infinite;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
        </svg>
        Reprinting...
      `;
      submitBtn.disabled = true;
      
      try {
        const formData = new FormData();
        formData.append('_token', document.querySelector('meta[name="csrf-token"]').getAttribute('content'));
        
        const response = await fetch(`/admin/print-certificate/${applicationId}`, {
          method: 'POST',
          body: formData
        });
        
        if (response.ok) {
          // Close modal
          closeReprintModal();
          
          // Show success notification
          showSuccessToast(`üîÑ Certificate reprinted successfully! Student: ${studentName}`);
          
          // Refresh page after delay
          setTimeout(() => {
            window.location.reload();
          }, 2000);
        } else {
          throw new Error('Failed to reprint certificate');
        }
      } catch (error) {
        console.error('Error reprinting certificate:', error);
        showErrorToast('‚ùå Error reprinting certificate. Please try again.');
        
        // Reset button
        submitBtn.innerHTML = originalContent;
        submitBtn.disabled = false;
      }
    }

    // Toast Notification Functions
    function showSuccessToast(message) {
      // Remove existing toasts
      const existingToasts = document.querySelectorAll('.success-toast');
      existingToasts.forEach(toast => toast.remove());
      
      const toast = document.createElement('div');
      toast.className = 'success-toast';
      toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #28a745, #20c997);
        color: white;
        padding: 16px 20px;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(40, 167, 69, 0.3);
        z-index: 10001;
        font-weight: 500;
        max-width: 400px;
        transform: translateX(100%);
        transition: transform 0.4s ease;
        display: flex;
        align-items: center;
        gap: 12px;
      `;
      
      toast.innerHTML = `
        <svg style="width: 20px; height: 20px; flex-shrink: 0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
        </svg>
        <span>${message}</span>
      `;
      
      document.body.appendChild(toast);
      
      // Animate in
      setTimeout(() => {
        toast.style.transform = 'translateX(0)';
      }, 100);
      
      // Auto remove after 4 seconds
      setTimeout(() => {
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => toast.remove(), 400);
      }, 4000);
    }

    function showErrorToast(message) {
      // Remove existing toasts
      const existingToasts = document.querySelectorAll('.error-toast');
      existingToasts.forEach(toast => toast.remove());
      
      const toast = document.createElement('div');
      toast.className = 'error-toast';
      toast.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: linear-gradient(135deg, #dc3545, #c82333);
        color: white;
        padding: 16px 20px;
        border-radius: 12px;
        box-shadow: 0 8px 25px rgba(220, 53, 69, 0.3);
        z-index: 10001;
        font-weight: 500;
        max-width: 400px;
        transform: translateX(100%);
        transition: transform 0.4s ease;
        display: flex;
        align-items: center;
        gap: 12px;
      `;
      
      toast.innerHTML = `
        <svg style="width: 20px; height: 20px; flex-shrink: 0;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
        <span>${message}</span>
      `;
      
      document.body.appendChild(toast);
      
      // Animate in
      setTimeout(() => {
        toast.style.transform = 'translateX(0)';
      }, 100);
      
      // Auto remove after 5 seconds
      setTimeout(() => {
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => toast.remove(), 400);
      }, 5000);
    }

    // Good Moral Application Modal
    function openGoodMoralModal(button) {
      const app = JSON.parse(button.getAttribute('data-application'));
      document.getElementById('modal').style.display = 'flex';
      document.getElementById('modalFullName').innerText = app.fullname ?? 'N/A';
      document.getElementById('modalrefnum').innerText = app.reference_number ?? 'N/A';
      document.getElementById('modalnumcop').innerText = app.number_of_copies ?? 'N/A';

      // Calculate and display payment amount
      const copies = parseInt(app.number_of_copies) || 1;
      const reasonCount = Array.isArray(app.reason) ? app.reason.length : 1;
      const totalAmount = reasonCount * copies * 50;
      const reasonText = reasonCount === 1 ? 'reason' : 'reasons';
      const copyText = copies === 1 ? 'copy' : 'copies';
      document.getElementById('modalPaymentAmount').innerText = `‚Ç±${totalAmount.toFixed(2)} (${reasonCount} ${reasonText} √ó ${copies} ${copyText} √ó ‚Ç±50.00)`;
      document.getElementById('modalCertificateType').innerText = app.certificate_type === 'good_moral' ? 'Good Moral Certificate' : 'Certificate of Residency';
      document.getElementById('modalStatus').innerText = app.application_status ?? 'N/A';
      document.getElementById('modalReason').innerText = Array.isArray(app.reason) ? app.reason.join(', ') : (app.reason ?? 'N/A');
      document.getElementById('modalCourseCompleted').innerText = app.course_completed ?? 'N/A';
      document.getElementById('modalGraduationDate').innerText = app.graduation_date ?? 'N/A';
      document.getElementById('modalUndergraduate').innerText = (app.is_undergraduate) ? 'Yes' : 'No';
      document.getElementById('modalLastCourseYearLevel').innerText = app.last_course_year_level ?? 'N/A';
      document.getElementById('modalLastSemesterSY').innerText = app.last_semester_sy ?? 'N/A';
    }

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
    }

    // Close modal when clicking outside
    document.getElementById('modal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeModal();
      }
    });

    // Initialize first tab as active
    document.addEventListener('DOMContentLoaded', function() {
      showTab('all');
    });
  </script>

</x-dashboard-layout>
